{
  function Integer(i) {
    this.value = i;
  }

  function BinaryExpression(l, r, o) {
    this.left = l;
    this.right = r;
    this.op = o;
  }

  function AssignmentStatement(i, e) {
    this.ident = i;
    this.expression = e;
  }

  function DoWhileStatement(s, c) {
    this.statements = s;
    this.condition = c;
  }

  function Ident(n) {
    this.name = n;
  }
}

start
  = statements

statements
  = statement *

statement
  = assignmentStatement
  / doWhileStatement

assignmentStatement
  = i:ident "=" e:expression { return new AssignmentStatement(i, e); }

doWhileStatement
  = "do" "{" s:statement "}" "while" "(" c:expression ")" { return new DoWhileStatement(s, c); }

expression
  = additive
  / multiplicative

additive
  = left:multiplicative "+" right:additive { return new BinaryExpression(left, right, "+"); }
  / multiplicative

multiplicative
  = left:primary "*" right:multiplicative { return new BinaryExpression(left, right, "*"); }
  / primary

primary
  = integer
  / "(" additive:additive ")" { return additive; }

integer "integer"
  = digits:[0-9]+ { return new Integer(parseInt(digits.join(""), 10)); }

ident
  = name:[a-z]* { return new Ident(name) }
